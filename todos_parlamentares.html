<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Todos os Parlamentares â€“ Scrivi Italia</title>

  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Seu CSS (opcional) -->
  <link rel="stylesheet" href="style.css">

  <style>
    body {
      padding: 2rem;
      font-family: Arial, sans-serif;
    }
    table {
      width: 100%;
      margin-top: 2rem;
    }
    th, td {
      text-align: center;
      vertical-align: middle;
    }
    .btn-success {
      font-size: 1rem;
      padding: 0.5rem 1rem;
    }
  </style>
</head>
<body>

  <!-- Header padrÃ£o -->
  <div id="header"></div>

  <div class="container">
    <h2 class="text-center mb-4">ğŸ“‹ Enviar mensagem a TODOS os parlamentares</h2>

    <p class="text-center text-muted">
      Copie todos os e-mails para envio de mensagem com um clique.
    </p>

    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Parlamentares</th>
          <th>Quantidade</th>
          <th>ğŸ“¤ Copiar Emails</th>
        </tr>
      </thead>
      <tbody id="tabela-parlamentares">
        <!-- conteÃºdo dinÃ¢mico -->
      </tbody>
    </table>

    <div class="text-center mt-4">
      <a href="index.html#como-utilizar" class="btn btn-outline-primary">
        â¬…ï¸ Voltar ao InÃ­cio
      </a>
    </div>
  </div>

  <!-- Modal Bootstrap -->
  <div class="modal fade" id="modalEmails" tabindex="-1" aria-labelledby="modalEmailsLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title" id="modalEmailsLabel">ğŸ“¬ Emails copiados com sucesso!</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          <p>âš ï¸ Alguns programas de email podem ter limite de destinatÃ¡rios.</p>
          <p>âœ‰ï¸ Abra seu programa de email (Gmail, Outlook etc.).<br>
             ğŸ“‹ Cole os emails no campo <strong>Cco</strong> (CÃ³pia Oculta), <em>nÃ£o</em> no campo "Para".</p>
          <p><strong>Por que usar o campo Cco?</strong><br>
          ğŸ”’ Privacidade â€” os destinatÃ¡rios nÃ£o verÃ£o os e-mails uns dos outros.<br>
          ğŸ“¬ Entrega confiÃ¡vel â€” reduz o risco de sua mensagem ser marcada como spam.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    async function carregarDados() {
      const [senadores, deputados] = await Promise.all([
        fetch('senadores_italianos.json').then(r => r.json()),
        fetch('deputados_italianos.json').then(r => r.json())
      ]);

      const tabela = document.getElementById('tabela-parlamentares');

      const gerarLinha = (titulo, dados, id) => {
        const quantidade = dados.length;
        const emails = dados.map(p => `${p.nome_completo} <${p.email}>`).join(', ');
        const linha = `
          <tr>
            <td>${titulo}</td>
            <td>${quantidade}</td>
            <td>
              <button class="btn btn-outline-success" onclick="copiarEmails('${id}')">Copiar emails</button>
              <textarea id="${id}" class="visually-hidden">${emails}</textarea>
            </td>
          </tr>`;
        return { linha, emails };
      };

      const l1 = gerarLinha('Senadores', senadores, 'senadores');
      const l2 = gerarLinha('Deputados', deputados, 'deputados');
      const l3 = gerarLinha('Todos', [...senadores, ...deputados], 'todos');

      tabela.innerHTML = l1.linha + l2.linha + l3.linha;
    }

    function copiarEmails(id) {
      const textarea = document.getElementById(id);
      textarea.classList.remove('visually-hidden');
      textarea.select();
      document.execCommand('copy');
      textarea.classList.add('visually-hidden');

      // Exibir modal de confirmaÃ§Ã£o
      const modal = new bootstrap.Modal(document.getElementById('modalEmails'));
      modal.show();
    }

    // Carrega conteÃºdo dinÃ¢mico ao iniciar
    carregarDados();

    // Carrega header/footer externos
    window.onload = () => {
      fetch('header.html').then(res => res.text()).then(html => {
        document.getElementById('header').innerHTML = html;
      });
      fetch('footer.html').then(res => res.text()).then(html => {
        const footer = document.createElement('div');
        footer.innerHTML = html;
        document.body.appendChild(footer);
      });
    };
  </script>

</body>
</html>
