<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Envio Direto de E-mails | Scrivi Italia</title>
  <link rel="stylesheet" href="style.css">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-THJPKCPYSZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-THJPKCPYSZ');
  </script>
</head>
<body>

  <!-- Header -->
  <div id="header-placeholder"></div>

  <main class="container">
    <h1>ğŸ“§ Envio Direto</h1>

    <p>âš ï¸ <strong>AtenÃ§Ã£o:</strong> nenhum e-mail Ã© enviado automaticamente.<br>
    VocÃª terÃ¡ total controle sobre o envio e poderÃ¡ editar o conteÃºdo conforme desejar, diretamente no seu cliente de e-mail.</p>

    <p>ğŸ“¬ Esta ferramenta facilita o envio de mensagens para <strong>parlamentares italianos</strong>, preenchendo automaticamente o campo 
    <strong>Cco (com cÃ³pia oculta)</strong> â€” isso garante a <strong>privacidade dos destinatÃ¡rios</strong>.</p>

    <p>ğŸ”„ Um <strong>assunto</strong> e uma <strong>mensagem</strong> sÃ£o escolhidos automaticamente, mas vocÃª pode:</p>
    <ul>
      <li><a href="modelos.html">escolher outro modelo de mensagem</a></li>
      <li><a href="senadores.html">selecionar senadores</a></li>
      <li><a href="deputados.html">selecionar deputados</a></li>
    </ul>

    <p>ğŸ’¡ <strong>Dicas importantes:</strong><br>
    - Use a tecla <kbd>TAB</kbd> para navegar pelos campos do seu e-mail.<br>
    - âœï¸ <strong>NÃ£o se esqueÃ§a de escrever seu nome ao final da mensagem!</strong></p>

    <p>âœ… <strong>Pronto!</strong> Agora Ã© sÃ³ enviar.</p>

    <table>
      <thead>
        <tr>
          <th style="width: 80px;">Cargo</th>
          <th style="width: 170px;">AÃ§Ã£o</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Senadores</td>
          <td><div id="btn-senadores" style="display: flex; gap: 10px;"></div></td>
        </tr>
        <tr>
          <td>Deputados</td>
          <td><div id="btn-deputados" style="display: flex; gap: 10px;"></div></td>
        </tr>
      </tbody>
    </table>
  </main>

  <!-- Footer -->
  <div id="footer-placeholder"></div>

  <script>
    const titulos = [
      "Difendiamo la cittadinanza italiana per discendenza",
      "Appello contro il Decreto-Legge 36/2025",
      "Tutela dei diritti dei cittadini italo-discendenti",
      "Preservare lâ€™identitÃ  italiana oltre i confini",
      "No alla stretta sulla cittadinanza agli italiani allâ€™estero"
    ];

    async function gerarBotoesEmail(tipo, containerId) {
      try {
        const res = await fetch(`${tipo}.json`);
        const parlamentares = await res.json();
        const mensagensRes = await fetch('mensagens.json');
        const mensagens = await mensagensRes.json();
        const emails = parlamentares
        .filter(p => p.email && p.nome_completo)
        .map(p => `${p.nome_completo} <${p.email}>`);
        const partes = Math.ceil(emails.length / 135);
        const container = document.getElementById(containerId);
        container.innerHTML = ''; // limpar antes

        for (let i = 0; i < partes; i++) {
          const grupo = emails.slice(i * 135, (i + 1) * 135).join(',');
          const titulo = encodeURIComponent(titulos[Math.floor(Math.random() * titulos.length)]);
          const corpo = encodeURIComponent(
            Array.isArray(mensagens) 
              ? mensagens[Math.floor(Math.random() * mensagens.length)].it
              : mensagens.it
          );
          const mailto = `mailto:?bcc=${grupo}&subject=${titulo}&body=${corpo}`;

          const btn = document.createElement('a');
          btn.href = mailto;
          btn.innerHTML = `<button class="btn-verde">Enviar e-mail ${i + 1} de ${partes}</button>`;
          container.appendChild(btn);
        }
      } catch (error) {
        console.error("Erro ao gerar botÃµes de email:", error);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      fetch("header.html")
        .then(res => res.text())
        .then(data => {
          document.getElementById("header-placeholder").innerHTML = data;
        });

      fetch("footer.html")
        .then(res => res.text())
        .then(data => {
          document.getElementById("footer-placeholder").innerHTML = data;
        });

      gerarBotoesEmail('senadores_italianos', 'btn-senadores');
      gerarBotoesEmail('deputados_italianos', 'btn-deputados');
    });
  </script>
</body>
</html>
